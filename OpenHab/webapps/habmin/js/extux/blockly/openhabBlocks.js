/*! HABmin 2014-06-20 */
Blockly.Blocks.openhab_persistence_get={init:function(){this.setHelpUrl("http://www.example.com/"),this.setColour(290),this.appendDummyInput().setAlign(Blockly.ALIGN_LEFT).appendField("Get").appendField(new Blockly.FieldDropdown([["state","STATE"],["average","AVERAGE"],["minimum","MINIMUM"],["maximum","MAXIMUM"]]),"TYPE").appendField("of Item").appendField(new Blockly.FieldVariable("Item"),"ITEM"),this.appendDummyInput().setAlign(Blockly.ALIGN_RIGHT).appendField("since").appendField(new Blockly.FieldDropdown([["midnight","MIDNIGHT"],["current time","TIME"]],this.customChangeHandler),"SINCE"),this.setOutput(!0,["Number","String"])},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)},mutationToDom:function(){var a={};a.name="SINCE",a.value=this.getFieldValue("SINCE");var b=[];return b.push(a),b},domToMutation:function(a){this.arguments_=[];for(var b=[].concat(a),c=0;c<b.length;c++)"since"==b[c].name.toLowerCase()&&"time"==b[c].value.toLowerCase()&&this.appendDummyInput("TIME").setAlign(Blockly.ALIGN_RIGHT).appendField("minus").appendField(new Blockly.FieldTextInput("0",Blockly.FieldTextInput.numberValidator),"NUM").appendField(new Blockly.FieldDropdown([["seconds","SECONDS"],["minutes","MINUTES"],["hours","HOURS"]]),"PERIOD")},customContextMenu:function(a){var b={enabled:!0},c=this.getFieldValue("VAR");b.text=this.contextMenuMsg_.replace("%1",c);var d=Ext.DomHelper.createDom({tag:"field",children:c});d.setAttribute("name","VAR");var e=Ext.DomHelper.createDom({tag:"block",children:d});e.setAttribute("type",this.contextMenuType_),b.callback=Blockly.ContextMenu.callbackFactory(this,e),a.push(b)},customChangeHandler:function(a){this.setValue(a),"TIME"==a?this.sourceBlock_.appendDummyInput("TIME").setAlign(Blockly.ALIGN_RIGHT).appendField("minus").appendField(new Blockly.FieldTextInput("0",Blockly.FieldTextInput.numberValidator),"NUM").appendField(new Blockly.FieldDropdown([["seconds","SECONDS"],["minutes","MINUTES"],["hours","HOURS"]]),"PERIOD"):this.sourceBlock_.removeInput("TIME"),this.sourceBlock_.render()}},Blockly.Blocks.openhab_rule={init:function(){this.setHelpUrl("HELP"),this.setColour(45),this.appendDummyInput().appendField(language.rule_DesignerRuleName).appendField(new Blockly.FieldTextInput(name,Blockly.Procedures.rename),"NAME").appendField("","PARAMS"),this.appendStatementInput("CONSTANT").appendField("Definitions"),this.appendStatementInput("STACK").appendField("Rule"),this.setTooltip(language.rule_DesignerRuleTooltip)}},Blockly.Blocks.openhab_iftimer={init:function(){this.setHelpUrl("BLAH"),this.setColour(120),this.appendValueInput("IF0").setCheck("Boolean").appendField("If"),this.appendDummyInput().setAlign(Blockly.ALIGN_LEFT).appendField("For").appendField(new Blockly.FieldTextInput("0",Blockly.FieldTextInput.numberValidator),"NUM").appendField(new Blockly.FieldDropdown([["seconds","SECONDS"],["minutes","MINUTES"],["hours","HOURS"]]),"PERIOD"),this.appendStatementInput("DO0").appendField("Do"),this.setPreviousStatement(!0),this.setNextStatement(!0);var a=this;this.setTooltip(function(){var b=a.getFieldValue("MODE"),c={WHILE:"While tooltip",UNTIL:"Until tooltip"};return c[b]})}},Blockly.Blocks.openhab_itemcmd={init:function(){this.setHelpUrl("bla"),this.setColour(290),this.interpolateMsg("Command Item %1 to %2",["ITEM",new Blockly.FieldVariable("command")],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip("command tooltip")},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)}},Blockly.Blocks.openhab_itemget={init:function(){this.setHelpUrl("BLAH"),this.setColour(290),this.appendDummyInput().appendField("Get Item").appendField(new Blockly.FieldVariable("Item"),"ITEM"),this.setOutput(!0),this.setTooltip("Get tooltip"),this.contextMenuMsg_="Make a set",this.contextMenuType_="openhab_itemset"},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)},customContextMenu:function(a){var b={enabled:!0},c=this.getFieldValue("ITEM");b.text=this.contextMenuMsg_.replace("%1",c);var d=Ext.DomHelper.createDom({tag:"field",children:c});d.setAttribute("name","ITEM");var e=Ext.DomHelper.createDom({tag:"block",children:d});e.setAttribute("type",this.contextMenuType_),b.callback=Blockly.ContextMenu.callbackFactory(this,e),a.push(b)}},Blockly.Blocks.openhab_state_onoff={init:function(){this.setHelpUrl("Help"),this.setColour(210),this.setOutput(!0,"State"),this.appendDummyInput().appendField(new Blockly.FieldDropdown([["On","ON"],["Off","OFF"]]),"STATE"),this.setTooltip("Tooltip")}},Blockly.Blocks.openhab_state_openclosed={init:function(){this.setHelpUrl("Help"),this.setColour(210),this.setOutput(!0,"State"),this.appendDummyInput().appendField(new Blockly.FieldDropdown([["Open","OPEN"],["Closed","CLOSED"]]),"STATE"),this.setTooltip("Tooltip")}},Blockly.Blocks.openhab_itemset={init:function(){this.setHelpUrl(Blockly.Msg.VARIABLES_SET_HELPURL),this.setColour(290),this.interpolateMsg("Set Item %1 to %2",["ITEM",new Blockly.FieldVariable("Item")],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip("Tooltip"),this.contextMenuMsg_="Get",this.contextMenuType_="openhab_itemget"},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)},customContextMenu:Blockly.Blocks.openhab_itemget.customContextMenu},Blockly.Blocks.openhab_itemget={init:function(){this.setHelpUrl("BLAH"),this.setColour(290),this.appendDummyInput().appendField("Get Item").appendField(new Blockly.FieldVariable("Item"),"ITEM"),this.setOutput(!0),this.setTooltip("Get tooltip"),this.contextMenuMsg_="Make a set",this.contextMenuType_="openhab_itemset"},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)},customContextMenu:function(a){var b={enabled:!0},c=this.getFieldValue("ITEM");b.text=this.contextMenuMsg_.replace("%1",c);var d=Ext.DomHelper.createDom({tag:"field",children:c});d.setAttribute("name","ITEM");var e=Ext.DomHelper.createDom({tag:"block",children:d});e.setAttribute("type",this.contextMenuType_),b.callback=Blockly.ContextMenu.callbackFactory(this,e),a.push(b)}},Blockly.Blocks.openhab_constantget={init:function(){this.setHelpUrl("BLAH"),this.setColour(45),this.appendDummyInput().appendField("Get Constant").appendField(new Blockly.FieldVariable("Constant"),"CONSTANT"),this.setOutput(!0),this.setTooltip("Get tooltip"),this.contextMenuMsg_="Make a set",this.contextMenuType_="openhab_constantset"},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)},customContextMenu:function(a){var b={enabled:!0},c=this.getFieldValue("ITEM");b.text=this.contextMenuMsg_.replace("%1",c);var d=Ext.DomHelper.createDom({tag:"field",children:c});d.setAttribute("name","CONSTANT");var e=Ext.DomHelper.createDom({tag:"block",children:d});e.setAttribute("type",this.contextMenuType_),b.callback=Blockly.ContextMenu.callbackFactory(this,e),a.push(b)}},Blockly.Blocks.openhab_constantset={init:function(){this.setHelpUrl(Blockly.Msg.VARIABLES_SET_HELPURL),this.setColour(45),this.interpolateMsg("Define Constant %1 as %2",["CONSTANT",new Blockly.FieldVariable("Constant")],["VALUE",null,Blockly.ALIGN_RIGHT],Blockly.ALIGN_RIGHT),this.setPreviousStatement(!0,"Constant"),this.setNextStatement(!0,"Constant"),this.setTooltip("Tooltip"),this.contextMenuMsg_="Set",this.contextMenuType_="openhab_constantget"},getVars:function(a){return[this.getFieldValue(a)]},renameVar:function(a,b,c){Blockly.Names.equals(b,this.getFieldValue(a))&&this.setFieldValue(c,a)},customContextMenu:Blockly.Blocks.openhab_constantget.customContextMenu};